/**
 * Simpli.js
 * A small library consists of some useful and shorthand function
 *
 * Copyright (c) 2016 Yu H.
 * 
 * @author Yu H.
 * @version 1.2.3
 * @license The MIT License (MIT)
 * https://opensource.org/licenses/MIT
 **/
"undefined"==typeof Object.create&&(Object.create=function(i){function e(){}return e.prototype=i,new e}),"undefined"==typeof String.prototype.nthIndexOf&&(String.prototype.nthIndexOf=function(i,e,r){var t,n,s,l=[],o=0;if(0===e)throw new TypeError("nthIndex cannot be 0 in String.nthIndexOf(searchValue, nthIndex, start)");for(t="undefined"==typeof r?-1:r-1,n=this.length;n>t;){if(t=this.indexOf(i,t+1),o+1===e)return t;if(-1===t)break;l[o++]=t}return 0>e&&(s=o+e,s>=0)?l[s]:-1});var getStackTrace=function(){var i=function(){return"undefined"!=typeof console?("undefined"==typeof console.debug&&(console.debug=console.log),console):{log:function(i){},info:function(i){},warn:function(i){},error:function(i){},debug:function(i){}}},e=new RegExp("^\\s+|\\s+$","g"),r=function(i){var r=Object.toString.call(i);return r=r.slice(r.indexOf("function")+8),callerName=r.slice(0,r.indexOf("(")).replace(e,""),0===callerName.length?"anonymous":callerName},t=new RegExp("^(?:\\s*at\\s?(.*)\\s|(.*)@)\\(?(.*):([1-9][0-9]*):([1-9][0-9]*)\\)?$"),n=function(i){var e,r=i.match(t);return null===r?null:(e="undefined"==typeof r[1]?r[2]:r[1],{invokedBy:""===e?"anonymous":e,file:r[3],line:r[4],column:r[5]})};return function(){var e,s,l,o,p,a=[],u=!0;try{var m;m.bar.baz=1}catch(c){if("undefined"!=typeof c.stack)for(u=!1,e=c.stack.split("\n"),o=null===e[0].match(t)?2:1,p=e.length;p>o&&0!==e[o].length;o++){if(l=n(e[o]),null===l){u=!0;break}"getStackTrace"!==l.invokedBy&&a.push(l)}if(u){i().error("[Warning] getStackTrace() running in compatibility mode");try{s=arguments.callee}catch(c){return i().error("[Warning] getStackTrace() compatibility mode cannot be run in strict mode"),null}for(;s.caller;)s=s.caller,a.push({invokedBy:r(s),file:void 0,line:void 0,column:void 0})}}return a}}(),simpli;!function(i){"use strict";var e=Object.prototype.toString,r=Object.prototype.hasOwnProperty,t="undefined"!=typeof window?window:i;simpli=function(){},simpli.version="1.2.3",simpli.console=function(){return simpli.isDefined(console)?(simpli.isDefined(console.debug)||(console.debug=console.log),console):{log:function(i){},info:function(i){},warn:function(i){},error:function(i){},debug:function(i){}}},simpli.forEachProperty=function(i,e){simpli.argc(arguments,["object","function"]);for(var t in i)r.call(i,t)&&e.call(i,t,i[t])},simpli.detailTypeOf=function(i){var e,r,t,n="array";if(simpli.isArray(i)){for(r=0,t=i.length;t>r;r++)"array"===n?n=simpli.getClass(i[r]):n!==simpli.getClass(i[r])&&(n="mixed");e=n+"["+i.length+"]"}else e=simpli.getClass(i);return e.toLowerCase()},simpli.getClass=function(r){var n=e.call(r);return r===i||r===t?"Global":n.slice(8,-1)},simpli.isA=function(i,e){if(!simpli.isString(e)&&!simpli.isFunction(e))throw new TypeError("Expected argument 2 to be 'string' or constructor, '"+simpli.detailTypeOf(className)+"' given");return simpli.isString(e)?simpli.getClass(i)===e:i instanceof e},simpli.isArguments=function(i){return simpli.isA(i,"Arguments")||!simpli.isA(arguments,"Arguments")&&simpli.isDefined(i)&&r.call(i,"callee")},simpli.argumentsToArray=function(i){var e,r,t=[];for(e=0,r=i.length;r>e;e++)t.push(i[e]);return t},simpli.isMixed=function(i){return"undefined"!=typeof i},simpli.isNull=function(i){return null===i},simpli.isDefined=function(i){return"undefined"!=typeof i},simpli.isDeepDefined=function(){var i,e,r,t=arguments.length;if(1>t)throw new TypeError("Expected argument 1 to have at least  1 object, 0 given");for(i=arguments[0],r=1;t>r;r++){if(e=arguments[r],!simpli.isInteger(e)&&!simpli.isString(e))throw new TypeError("Expected argument "+r+" to be 'integer' or 'string', "+typeof e+" given");if(i=i[e],!simpli.isDefined(i))return!1}return!0},simpli.isSet=function(i){return simpli.isDefined(i)&&!simpli.isNull(i)},simpli.isNaN=function(i){return i!==i},simpli.isObject=function(i){return"object"==typeof i&&!simpli.isArray(i)&&null!==i},simpli.isNumber=function(i){return"number"==typeof i},simpli.isFunction=function(i){return"function"==typeof i},simpli.isBoolean=function(i){return"boolean"==typeof i},simpli.isArray=function(i){var e=simpli.getClass(i);return"Array"===e?!0:"Array"!==simpli.getClass([])&&"Object"===e?simpli.isObject(i)&&simpli.isNumber(i.length):!1},simpli.isString=function(i){return"string"==typeof i},simpli.isInteger=function(i){return simpli.isNumber(i)&&i%1===0},simpli.isDecimal=function(i,e,r){var t,n=!1,s=!1;if(!simpli.isNumber(i))return!1;if(t=(i+"").split("."),simpli.isDefined(e)&&(n=!0,!simpli.isInteger(e)))throw new TypeError("Expected argument 2 to be 'integer', '"+simpli.detailTypeOf(e)+"' given");if(simpli.isDefined(r)&&2===t.length&&(s=!0,!simpli.isInteger(r)))throw new TypeError("Expected argument 3 to be 'integer', '"+simpli.detailTypeOf(r)+"' given");return n||s?(n?t[0].length===e:!0)&&(s?2===t.length?t[1].length<=r:!1:!0):!0},simpli.isChar=function(i){return simpli.isString(i)&&1===i.length},simpli.isObjectArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isObject(i[r]))return!1;return!0},simpli.isNumberArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isNumber(i[r]))return!1;return!0},simpli.isFunctionArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isFunction(i[r]))return!1;return!0},simpli.isBooleanArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isBoolean(i[r]))return!1;return!0},simpli.isIntegerArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isInteger(i[r]))return!1;return!0},simpli.isDecimalArray=simpli.isNumberArray,simpli.isStringArray=function(i,e){var r,t;if(!simpli.isArray(i))return!1;if(t=i.length,simpli.isDefined(e)){if(!simpli.isInteger(e))throw new TypeError("Expected arugment 2 to be 'interger', '"+simpli.detailTypeOf(e)+"' given");if(t!==e)return!1}for(r=0;t>r;r++)if(!simpli.isString(i[r]))return!1;return!0};var n={};n.INVALID_ARGUMENT=function(){return this instanceof n.INVALID_ARGUMENT?(this.index=-1,this.message="",void(this.error="")):new n.INVALID_ARGUMENT},n.INVALID_ARGUMENT.prototype.getMessage=function(){return this.message},n.INVALID_ARGUMENT.prototype.getIndex=function(){return this.index},n.INVALID_ARGUMENT.prototype.getError=function(){return this.error},n.MISMATCH_ARGNUMBER=function(i,e,r){var t,s;if(!(this instanceof n.MISMATCH_ARGNUMBER))return new n.MISMATCH_ARGNUMBER(i,e,r);for(n.INVALID_ARGUMENT.call(this),r=r||!1,s=i.length,this.message="Argument number mismatch: Expected "+(this.isLowerBound?"at least ":"")+e+" argument(s), "+s+" given",this.error=simpli.argv.MISMATCH_ARGNUMBER,t=0;s>t;t++)i[t].valid=!1,i[t].error=simpli.argv.MISMATCH_ARGNUMBER},n.MISMATCH_ARGNUMBER.prototype=Object.create(n.INVALID_ARGUMENT.prototype),n.MISMATCH_ARGNUMBER.prototype.constructor=n.MISMATCH_ARGNUMBER,n.UNEXPECTED_DATATYPE=function(i,e){var r;return this instanceof n.UNEXPECTED_DATATYPE?(n.INVALID_ARGUMENT.call(this),r=i[e],this.index=e,this.message="Expected '"+r.expected+"', '"+r.given+"' given",void(this.error=i[e].error=simpli.argv.UNEXPECTED_DATATYPE)):new n.UNEXPECTED_DATATYPE(i,e)},n.UNEXPECTED_DATATYPE.prototype=Object.create(n.INVALID_ARGUMENT.prototype),n.UNEXPECTED_DATATYPE.prototype.constructor=n.UNEXPECTED_DATATYPE,n.invalidHandler=function(i,r,t,n){var s,l,o,p,a,u,m,c,f,g,y,d="",E="",h="",T="";for(p=i.getMessage(),a=i.getIndex(),s=0,l=r.length,u="";l>s;)m=r[s].value,m=simpli.isString(m)?'"'+m+'"':simpli.isNumber(m)?m:e.call(m),u+=s===a?"-->"+m+"<--":m,++s<l&&(u+=", ");if(c=getStackTrace(),!simpli.isNull(c))for(f=!1,s=0,l=c.length;l>s;s++)if(c[s].invokedBy===t||c[s].invokedBy==="Function."+t){f=!0,o=s+1,E=c[o].file,h=c[o].line,T=c[o].column,d+=t+"("+u+"): "+p+" in "+E+" on line "+h;break}for((simpli.isNull(c)||!f)&&(d+=t+"("+u+"): "+p),g={arguments:[],invokedBy:t,file:E,line:h,column:T},s=0,l=r.length;l>s;s++)y=r[s],g.arguments.push({valid:y.valid,index:y.index,value:y.value,expected:y.expected,given:y.given}),simpli.isDefined(y.error)&&(g.arguments[s].error=y.error);if(simpli.isNull(n)||n.call(null,g),simpli.argv.errorMode()===simpli.argv.ERRMODE_ERROR)throw new TypeError(d);return!1},n.isType=function(i,e,r){if(simpli.isA(e,simpli.Type))return e.is(i);switch(e){case"*":return simpli.isMixed(i);case"array":return simpli.isArray(i);case"null":return simpli.isNull(i);case"object":return simpli.isObject(i);case"number":return simpli.isNumber(i);case"boolean":case"bool":return simpli.isBoolean(i);case"function":return simpli.isFunction(i);case"string":return simpli.isString(i);default:if(simpli.argv.mode()!==simpli.argv.MODE_EXTEND)throw new TypeError("Extend data type are not supported in Strict mode");switch(e){case"mixed":return simpli.isMixed(i);case"integer":case"int":return simpli.isInteger(i);case"decimal":case"float":case"double":return simpli.isDecimal(i);case"char":return simpli.isChar(i);case"mixed[]":return simpli.isArray(i,r);case"object[]":return simpli.isObjectArray(i,r);case"number[]":return simpli.isNumberArray(i,r);case"boolean[]":case"bool[]":return simpli.isBooleanArray(i,r);case"string[]":return simpli.isStringArray(i,r);case"integer[]":case"int[]":return simpli.isIntegerArray(i,r);case"decimal[]":case"float[]":case"double[]":return simpli.isDecimalArray(i,r);case"function[]":return simpli.isFunctionArray(i,r);case"char[]":if(!simpli.isString(i))return!1;if(simpli.isDefined(r))return i.length===r}}},n.typeRegEx=new RegExp("^(\\*|array|null|(mixed|object|number|boolean|bool|function|string|integer|int|decimal|float|double|char)(?:\\[([1-9][0-9]*)?\\])?)$"),n.optionalRegEx=/^\[[^\s]+\]$/,n.checkArg=function(i){var e,r,t,s,l,o,p=!1;for(i.optional&&!simpli.isDefined(i.value)&&(p=!0),e=0,r=i.signature.length;r>e;e++){if(s=i.signature[e],simpli.isA(s,simpli.Type))l=s;else{if(t=s.match(n.typeRegEx),null===t)throw new TypeError("Unrecognized data type '"+s+"'");if(p)continue;simpli.isDefined(t[3])&&""!==t[3]?(l=t[2]+"[]",o=parseInt(t[3])):(l=t[1],o=void 0)}n.isType(i.value,l,o)&&(p=!0)}return p},simpli.Type=function(i,e){if(!(this instanceof simpli.Type))return new simpli.Type(i,e);if(simpli.isString(i)){if(this._name=i,!simpli.isFunction(e))throw new TypeError("Expected argument 2 to be 'function', '"+typeof e+"' given");this._callback=e}else{if(!simpli.isFunction(i))throw new TypeError("Expected argument 1 to be 'string' or 'function', '"+typeof i+"' given");this._name="{simpli.Type}",this._callback=i}this._optional=!1,this._isArray=!1,this._size=0,this._repeatable=!1},simpli.Type.prototype._clone=function(){var i=new simpli.Type(this.getCallback());return i._optional=this.isOptional(),i._isArray=this.isArray(),i._size=this.getSize(),i._repeatable=this.isRepeatable(),i},simpli.Type.prototype._toFunction=function(){var i,e=this;return function(r){if(e.isOptional()&&!simpli.isDefined(r))return!0;if(e.isArray()){if(!simpli.isArray(r))return!1;if(i=e.getSize(),i>0&&r.length>i)return!1;for(var t=0;t<r.length;t++)if(!e.getCallback()(r[t]))return!1;return!0}return e.getCallback()(r)}},simpli.Type.prototype.getName=function(){return this._name},simpli.Type.prototype.isOptional=function(){return this._optional},simpli.Type.prototype.isArray=function(){return this._isArray},simpli.Type.prototype.getSize=function(){return this._size},simpli.Type.prototype.isRepeatable=function(){return this._repeatable},simpli.Type.prototype.getCallback=function(){return this._callback},simpli.Type.prototype.optional=function(){var i=this._clone();return i._optional=!0,i},simpli.Type.prototype.array=function(i){var e=this._clone();if(e._isArray=!0,simpli.isDefined(i)){if(!simpli.isInteger(i))throw new TypeError("Expected argument 1 to be 'integer', '"+typeof i+"'' given");if(0>=i)throw new TypeError("Expected argument 1 to be greater than 0, "+i+" given");e._size=i}else i="";return e._name=this.getName()+"["+i+"]",e},simpli.Type.prototype.repeatable=function(){var i=this._clone();return i._repeatable=!0,i},simpli.Type.prototype.is=function(i){return this._toFunction()(i)},simpli.argv=function(i){var e,r,t,s,l,o,p,a,u,m,c,f,g,y,d,E,h,T,A,v=simpli.argumentsToArray(arguments),b=v.length,w=null,D=[],N=null;if(!simpli.isArguments(i))throw new TypeError("Expected argument 1 to be 'Arguments' object, '"+simpli.detailTypeOf(i)+"' given");if(i=simpli.argumentsToArray(i),simpli.isFunction(v[b-1])&&(w=v[b-1],v.pop(),b--),b>2||2===b&&simpli.isString(v[1])||simpli.isA(v[1],simpli.Type))t=v,t.shift();else if(2!==b||!(t=v[1])||!simpli.isArray(t))throw new TypeError("Expected argument 2 to be 'string', 'array' or 'simpli.Type', '"+simpli.detailTypeOf(v[1])+"' given");for(s=i.length,l=simpli.isDefined(t)?t.length:0,e=0;s>e;e++)D.push({valid:!1,index:e,value:i[e],expected:"",given:simpli.detailTypeOf(i[e]),signature:null,optional:!1});for(c=0,m=!1,f=!1,o=0,p=0;l>o;){if(a=t[o],u=!1,simpli.isA(a,simpli.Type))u=a.isOptional(),c+=a.isRepeatable()?1:0,g=a.getName(),y=[a];else{if(!simpli.isString(a))throw new TypeError("Expected signature to be 'string' or 'simpli.Type', '"+simpli.detailTypeOf(a)+"' given");for(u=n.optionalRegEx.test(a)&&(a=a.slice(1,-1)),c+="..."===a.slice(0,3)&&(a=a.slice(3))?1:0,g=a.replace("|",","),y=a.split("|"),e=0,r=y.length;r>e;e++)if(!n.typeRegEx.test(y[e]))throw new TypeError("Expected signature to be one of the valid types, '"+y[e]+"' given")}if(s>p&&(D[p].expected=g,D[p].signature=y,D[p].optional=u),u)m=!0;else{if(m)throw new TypeError("Optional argument must appear at the end of the declaration");p===s&&(N=n.MISMATCH_ARGNUMBER(D,l,c))}if(1===c){if(f)throw new TypeError("Variable-length argument must be the last signature of the declaration");for(o+1!==l&&(f=!0),p+=1;s>p;p++)D[p].expected=g,D[p].signature=y,D[p].optional=u}else if(2===c)throw new TypeError("Only one variable-length argument is allowed in the declaration");o++,p++}if(s>p&&(N=n.MISMATCH_ARGNUMBER(D,l)),simpli.isNull(N))for(e=0,r=D.length;r>e;e++)if(d=D[e],!n.checkArg(d)){simpli.isNull(N)&&(N=n.UNEXPECTED_DATATYPE(D,e));break}if(!simpli.isNull(N)){if(E=getStackTrace(),!simpli.isNull(E))for(h=!1,T=E.length,e=0;T>e;e++)("simpli.argv"===E[e].invokedBy||"Function.simpli.argv"===E[e].invokedBy)&&(h=!0,A=E[e+1].invokedBy);return(simpli.isNull(E)||!h)&&(A="function"),n.invalidHandler(N,D,A,w)}return!0},simpli.argv.UNEXPECTED_DATATYPE="{UNEXPECTED_DATATYPE}",simpli.argv.MISMATCH_ARGNUMBER="{MISMATCH_ARGNUMBER}",simpli.argv.MODE_STRICT="{MODE_STRICT}",simpli.argv.MODE_EXTEND="{MODE_EXTEND}",simpli.argv.ERRMODE_ERROR="{ERRMODE_ERROR}",simpli.argv.ERRMODE_SILENT="{ERRMODE_SILENT}",simpli.argv.mode=function(i){if(simpli.isDefined(i)){if(i!==simpli.argv.MODE_STRICT&&i!==simpli.argv.MODE_EXTEND)throw new TypeError("Unrecognized mode '"+i+"'");n.mode=i}return n.mode},simpli.argv.errorMode=function(i){if(simpli.isDefined(i)){if(i!==simpli.argv.ERRMODE_ERROR&&i!==simpli.argv.ERRMODE_SILENT)throw new TypeError("Unrecognized error mode '"+i+"'");n.errorMode=i}return n.errorMode},simpli.argv.mode(simpli.argv.MODE_EXTEND),simpli.argv.errorMode(simpli.argv.ERRMODE_ERROR)}("undefined"==typeof window?global:window);
    